$(document).ready(function(){var ht;let z,m,s,l,W,f=0,I=0,h=!1,G=!1,y=!1,j=!1,L=!1,S,C,u=null,p=null;const _=5e3,pt=5e3;let v=null,q=null,D=null,Z=0,H=null,V=!1,x=!1,b=!1,K=null,tt=!1,et=!1,it,T=0;const F=((ht=window.Laravel)==null?void 0:ht.user_id)||"Non-Logged-In";window.generateStoryCards=function(){let t=[],e=[],i=[],n=[],a=new Set,r=new Set;$(".stories_parent .stories_card").each(function(){let o=$(this).data("instituteid");o&&a.add(o)});let d=!1;$(".story_data_get").each(function(){const o=$(this),c=o.data("instituteid");if(!c||(r.add(c),a.has(c)))return;d=!0,a.add(c);const g=o.data("name"),w=o.data("location"),k=o.data("featured-logo")||o.data("logo")||'{{Vite::asset("resources/images/no-image87x85.webp")}}',N=!!o.data("featured-logo"),Y=o.data("courseid"),O=`
            <div class="stories_card" data-index="0" data-instituteid="${c}">
                <div class="story-image trigger_ga_on_click" data-sent-event="0" data-type="sr_story_listing" data-position="0" data-course-id="${Y}"  data-instituteid="${c}" data-name="${g}" data-logo="${k}" data-location="${w}">
                    <img data-instituteid="${c}" alt="${g}" title="${g}" class="img-fluid ${N?"featured-logo":"normal-logo"}" loading="lazy" src="${k}">
                </div>
                <div class="story-heading">
                    <p>${g}</p>
                </div>
            </div>`,R=zt(c,g,k,w);N?(t.push(O),i.push(R)):(e.push(O),n.push(R))}),$(".stories_parent .stories_card").each(function(){let o=$(this).data("instituteid");o&&!r.has(o)&&$(this).remove()}),d&&($(".stories_parent").append(t.join("")+e.join("")),$(".stories_parent").append(i.join("")+n.join("")))};function mt(){tt||($(".stories_parent").html(""),et||(typeof window.generateStoryCards=="function"?window.generateStoryCards():console.error("generateStoryCards is not defined"),et=!0),tt=!0)}setTimeout(mt,5e3);function at(){if(typeof isGuestUser<"u"&&isGuestUser){const t=document.getElementById("registrationModal");t?new MutationObserver(function(i){i.forEach(function(n){$("#registrationModal").css("display")==="none"&&b&&(ct(),b=!1)})}).observe(t,{attributes:!0,attributeFilter:["style"]}):(console.warn("#registrationModal element not found. Retrying..."),setTimeout(at,1e3))}}at(),$(".stories_parent").off("click",".story-image").on("click",".story-image",function(){if(!j){if(j=!0,$(".stories_card").attr("data-index","0"),l=$(this).closest(".stories_card"),l.attr("data-index","1"),y){j=!1;return}u=l.data("instituteid"),p=$(this).data("course-id")||"",s=$('.stories_data_wrapper[data-instituteid="'+u+'"]'),s.length&&($(".stories_data_wrapper").hide().css("z-index",""),s.stop(!0,!0).show().css("z-index","110"),m=s.find(".stories_data_div"),X(l,s),J(u,p,s)),j=!1}});function X(t,e){z=$(".stories_card"),l=t,s=e,u=l.data("instituteid");let i=l.data("name"),n=l.data("logo"),a=l.data("location");!s||!s.length||(m=s.find(".stories_data_div"),m.hide().first().show(),_t(u,i,n,a,s))}function J(t,e,i){L=!1,G=!1,h=!1,clearInterval(S),clearTimeout(C),f=0,u=t,p=e,s=i,m=s.find(".stories_data_div"),m.hide().first().show();let n=s.find(".slider_indicator .fill");n.css({width:"0%",transition:"none"}),requestAnimationFrame(()=>{n.css({transition:`width ${_}ms linear`})}),vt(u,p,s),Pt(),P(s)}function _t(t,e,i,n,a){u=t,s=a,$(".stories_heading .clgNameLogo img").attr({src:i,alt:e}),$(".stories_heading .clgNameLogo p").text(e),s.find(".collegeName").text(e),s.find(".stories_content small").text(n),s.find(".applyNowBtn").attr({"data-instituteId":u,"data-name":e,"data-logo":i})}function vt(t,e,i){!i.length||i.attr("data-check")==="1"||(u=t,p=e,s=i,s.attr("data-check","1"),$.ajax({url:"/collegesAjax",method:"POST",headers:{"X-CSRF-TOKEN":$('meta[name="csrf-token"]').attr("content")},data:{action:"getStory",institute_id:u,course_id:p},dataType:"json",success:function(n){if(!(n!=null&&n.data))return;const{totalPrograms:a,totalCourses:r,popularDomains:d,highest_package:o,totalRecruiters:c,recruiters:g,ranks:w,background_image:k,randomImages:N}=n.data;I=0,s.find(".stories_data_div").each((Y,O)=>{const R=$(O).find(".stories_data_overlay");R.length&&$t(k,N,Y,gt=>{gt&&(R.css({"background-image":`linear-gradient(0deg, rgba(0, 0, 0, 0.75) 39%, rgba(255, 255, 255, 0.1) 100%), url(${gt})`,"background-size":"cover","background-position":"center"}),I++)})}),xt(s,{courses:a,streams:r}),Tt(s,{popularDomains:d||[]}),kt(s,{highlightpackage:o?`INR ${o} LPA`:"-",totalrecruiter:c?`${c}+ Recruiters`:"-",recruiters:g||[]}),!o&&!c&&!(g!=null&&g.length)&&s.find(".third_slide").remove(),w!=null&&w.length?Ct(s,w):s.find(".fourth_slide").remove(),bt(s),I>0&&Nt(I)},error:function(n,a,r){console.error("Error fetching story data:",a,r)}}))}function $t(t=[],e=[],i,n){var r;const a=St((r=t[i])==null?void 0:r.file_name)?st(t[i].file_name):"";yt(a).then(d=>{n(d?a:wt(e))})}function wt(t=[]){return t.length?st(t[Math.floor(Math.random()*t.length)]):""}function yt(t){return new Promise(e=>{if(!t)return e(!1);let i=new Image;i.onload=()=>e(!0),i.onerror=()=>e(!1),i.src=t})}function st(t){return t.includes("%")?t:encodeURI(t)}function St(t){return typeof t=="string"&&!/[^\w-.~:/?#[\]@!$&'()*+,;=%]/.test(t)}function xt(t,{courses:e,streams:i}){let n=t.find(".stories_content_left"),a=t.find(".stories_content_right");e?n.find("p").text(`${e} Programs`):n.remove(),i?a.find("p").text(`${i} Courses`):a.remove()}function Tt(t,{popularDomains:e}){t.find(".popular-domain-text").text(e.length?e.map(i=>i.name).join(" "):"No popular domains available"),t.find(".domain-popular").text("Popular Domains")}function kt(t,{highlightpackage:e,totalrecruiter:i,recruiters:n}){let a=t.find(".highest-package"),r=t.find(".highlight-description"),d=t.find(".total-recruiters-label"),o=t.find(".total-recruiters"),c=t.find(".recruiter-logos-wrap"),g=t.find(".heading-recruiter");if(e&&e!=="-"?r.text(e).show():a.add(r).remove(),i&&i!=="-"?o.text(i).show():d.add(o).remove(),n.length){let w=n.slice(0,5).map(({icon:k,name:N})=>`<div class="recruiter-logos-mid">
                        <img src="${k}" alt="Recruiter Logo">
                        <p>${N}</p>
                    </div>`).join("");c.html(w).show(),g.show()}else c.add(g).remove()}function Ct(t,e=[]){if(!e.length||!e.some(({rank:a,out_of:r})=>a&&r)){t.find(".fourth_slide").remove();return}let i=t.find(".fourth_content");i.length?i.empty():(t.append(`
                    <div class="fourth_slide">
                        <div class="fourth_content"></div>
                    </div>
                `),i=t.find(".fourth_content"));const n=e.filter(({rank:a,out_of:r})=>a&&r).sort((a,r)=>a.rank-r.rank).slice(0,2).map(({rank:a,ranking_body:r,year:d})=>`
                    <div class="ranked-data">
                        <p>Ranked #${a}</p>
                        <p class="highlight-description">${r.charAt(0).toUpperCase()+r.slice(1)} in ${d}</p>
                    </div>
                `).join("");i.append(n)}function bt(t){let e=t.find(".stories_data_div"),i=t.find(".slider_indicators");if(!i.length||!e.length)return;i.empty();let n=e.map((a,r)=>{let d=$(r);return`<span class="slider_indicator" data-index="${a}" data-instituteid="${d.attr("data-instituteid")}">
                            <span class="fill"></span>
                        </span>`}).get().join("");i.append(n)}function Q(t,e=!1,i){if(!(i!=null&&i.length))return;const n=i.find(".slider_indicator .fill");if(!n.length)return setTimeout(()=>Q(t,e,i),100);if(t<0||t>=n.length)return;const a=n.eq(t);if(e){n.css({width:"0%",transition:"none"});return}if(h||L)return;const r=parseFloat(window.getComputedStyle(a[0]).width),d=a.parent()[0].offsetWidth,o=r/d*100,c=_*(1-o/100);if(h){a.css({transition:"none",width:`${o}%`});return}requestAnimationFrame(()=>{setTimeout(()=>{h||L||a.css({width:"100%",transition:`width ${c}ms linear`})},50)})}function Nt(t){if(!(t!=null&&t.length))return;const e=t.find(".stories_data_div");e.length&&nt(0,e.length)}function nt(t,e,i){t>=e||typeof Q!="function"||setTimeout(()=>nt(t+1,e),5e3)}function M(t){if(h||(h=!0,!t||!t.is(":visible"))||(q=t.find(".slider_indicators"),D=q.find(`.slider_indicator[data-index="${f}"]`),v=D.find(".fill"),!v.length))return;let e=parseFloat(window.getComputedStyle(v[0]).width),i=parseFloat(v.parent()[0].offsetWidth),n=e/i*100;T=_*(1-n/100),v[0].offsetHeight,v.css({transition:"none",width:`${n}%`})}function A(t="default"){if(!h||(h=!1,s=$(".stories_data_wrapper:visible"),!s.length)||(m=s.find(".stories_data_div"),q=s.find(".slider_indicators"),D=q.find(`.slider_indicator[data-index='${f}']`),v=D.find(".fill"),!v.length))return;let e=f===m.length-1;T=T>0?T:_,clearTimeout(S),clearTimeout(C),v.css({transition:`width ${T}ms linear`,width:"100%"}),S=setTimeout(()=>{h||(e?U():(f++,P(s,null)))},T),e&&F==="Non-Logged-In"&&E(T)}function rt(){if(s=$(".stories_data_wrapper:visible"),!s.length)return;let t=s.find(".applyNowBtn");!t.length||y||(s.css("z-index","10"),t.attr("data-leadcta","story-auto-apply"),t.trigger("click"),dt(),y=!0,b=!0)}$(document).on("click",".applyNowBtn",function(){let t=$(this).closest(".stories_data_wrapper");t.length&&(t.css("z-index","10"),$(this).attr("data-leadcta")!=="story-auto-apply"&&$(this).attr("data-leadcta","story-swipe-apply"),M(t),dt(),y=!0,x=!0,b=!0,f===t.find(".stories_data_div").length-1&&(K=Date.now()))});const B=$("#successModal"),It=new MutationObserver(()=>{const t=$(".stories_data_wrapper:visible");t.length&&B.is(":visible")&&(B.css("z-index","9999"),M(t),y=!0,b=!0)});B.length&&It.observe(B[0],{attributes:!0,attributeFilter:["style","class"]});function P(t,e=null,i=null,n=!1){let a=t||$(".stories_data_wrapper:visible");if(!a.length)return;let r=a.find(".stories_data_div");if(!r.length||(e!==null&&(f=e),f>=r.length))return;r.hide();let d=r.eq(f);if(!d.length)return;d.show(),Q(f,!1,a),clearTimeout(S);let o=i||pt;if(f===r.length-1){if(Z=Date.now(),F==="Non-Logged-In")H=i||o,E(H);else{let c=Z+o;setTimeout(()=>{f===r.length-1&&U()},c-Date.now())}return}n||(S=setTimeout(()=>{h||(f++,P(a))},o))}function E(t){if(x)return;clearTimeout(C);let i=$(".stories_data_wrapper:visible").find(".stories_data_div");if(i.index(i.filter(":visible"))!==i.length-1)return;let a=t&&t>1e3?t-1e3:_-1e3;a>0&&(C=setTimeout(()=>{if(h||x){console.log("Animation still paused, skipping last slide event.");return}rt()},a))}function ot(t){let e=$(".stories_data_wrapper:visible");if(!e.length)return;let i=e.find(".stories_data_div"),n=e.find(".slider_indicators .fill"),a=i.length;a&&(t==="next"?(V=!0,Lt(e,i,n,a,!0)):Ft(e,i,n))}function Lt(t,e,i,n,a=!1){let r=e.filter(":visible"),d=e.index(r),o=d+1;if(o>=n){t.data("lastSlideTriggered")||(t.data("lastSlideTriggered",!0),i.eq(d).css({transition:"none",width:"100%"}),a?(rt(),t.data("manualLastSlideClick",!0),F!=="Non-Logged-In"&&U()):E(H||_));return}At(t,e,i,d,o)}function Ft(t,e,i){let n=e.filter(":visible"),a=e.index(n),r=a-1;if(r<0){Rt();return}clearTimeout(C),i.eq(a).css({transition:"none",width:"0%"}),n.hide(),e.eq(r).show();let o=i.eq(r);o.css({transition:"none",width:"0%"}),setTimeout(()=>{o.css({transition:`width ${_/1e3}s linear`,width:"100%"})},50),P(t,r)}function At(t,e,i,n,a){i.eq(n).css({transition:"none",width:"100%"}),e.eq(n).hide(),e.eq(a).show();let r=i.eq(a).css({transition:"none",width:"0%"});setTimeout(()=>{r.css({transition:`width ${_/1e3}s linear`,width:"100%"})},50),P(t,a)}function Pt(){let t=$(".stories_data_wrapper:visible");t.length&&(t.find(".next_story").off("click").on("click",()=>ot("next")),t.find(".previous_story").off("click").on("click",()=>ot("prev")),t.find(".closeStories").off("click").on("click",ut))}function U(){let t=l.next(".stories_card");t.length||ut(),lt(l),l.removeAttr("data-index"),l=t,l.attr("data-index","1").show(),u=l.data("instituteid"),p=l.find(".story-image").data("course-id")||"",s=$('.stories_data_wrapper[data-instituteid="'+u+'"]'),s.length&&($(".stories_data_wrapper").hide().css("z-index",""),s.show().css("z-index","110"),ft(s),X(l,s),J(u,p,s))}function Rt(){if(!l||!l.length||(z=$(".stories_card"),W=z.index(l),W===0))return;let t=z.eq(W-1);t.length&&($(".stories_data_wrapper").hide().css("z-index",""),l.hide().removeAttr("data-index"),t.show().attr("data-index","1"),l=t,u=l.data("instituteid"),p=l.find(".story-image").data("course-id")||"",s=$('.stories_data_wrapper[data-instituteid="'+u+'"]'),s.length&&(s.show().css("z-index","110"),s.removeData("lastSlideTriggered"),s.removeData("manualLastSlideClick"),m=s.find(".stories_data_div"),X(l,s),J(u,p,s)))}function lt(t){t.find(".story-image").hasClass("viewed")||t.find(".story-image").addClass("viewed")}function dt(){if(L||G||!s||!s.length)return;let t=s.find(".slider_indicators");clearInterval(S);let e=t.find(".fill").eq(f);if(!e.length||!e.parent().length)return;let i=parseFloat(window.getComputedStyle(e[0]).width),n=parseFloat(window.getComputedStyle(e.parent()[0]).width);if(isNaN(i)||isNaN(n)||n===0)return;let a=(1-i/n)*_;window.remainingTime=Math.max(a,1e3),h=!0,e.css({transition:"none",width:i+"px"}),f===$(".stories_data_div").length-1&&clearTimeout(C)}function ct(){let t=$(".stories_data_wrapper:visible");if(t.length&&t.is(":visible")&&h){if(t.css("z-index","110"),V&&t.data("lastSlideTriggered")){U();return}if(t.data("handleLastSlideTriggered")&&!t.data("lastSlideTriggered"))t.data("handleLastSlideTriggered",!1),t.data("lastSlideTriggered",!0),A("handleLastSlideTriggered"),y=!1,x=!1;else if(x){if(A("manualApplyNowClick"),x=!1,y=!1,f===t.find(".stories_data_div").length-1){let e=K?Date.now()-K:0,i=Math.max(T-e-1e3,0);i>0&&setTimeout(()=>{x||E(0)},i)}}else A("normalClose")}}$(document).on("click",".close",function(){ct(),b=!1});function ut(){var t;clearInterval(S),f=0,I=0,$(".stories_data_wrapper").hide(),l&&l.length&&lt(l),l=null,s=null,m=null,u=null,(t=$(".slider_indicators .fill")[0])==null||t.offsetWidth,$(".slider_indicators .fill").css("transition","width 5s linear"),ft()}function ft(t){!t||!t.length||(h=!1,L=!1,G=!1,y=!1,V=!1,x=!1,t.data({lastSlideTriggered:!1,handleLastSlideTriggered:!1}),t.css("z-index","110"),clearInterval(S))}function zt(t,e,i,n){let r=[{className:"first_slide",content:`
                    <div class="stories_content first_content">
                        <p class="collegeName">${e}</p>
                        <small class="stateCityName">${n}</small>
                    </div>
                    <div class="stories_content_flex">
                        <div class="stories_content_left">
                            <span>Over</span>
                            <p></p>
                        </div>
                        <div class="stories_content_right">
                            <span>Across</span>
                            <p>Courses</p>
                        </div>
                    </div>
                `},{className:"second_slide",content:`
                    <div class="stories_content second_content">
                        <p class="domain-popular">Popular Domains</p>
                        <p class="popular-domain-text"></p>
                    </div>
                `},{className:"third_slide",content:`
                    <div class="stories_content third_content">
                        <p class="highlight-title highest-package">Highest Package</p>
                        <p class="highlight-description"></p>
                        <p class="highlight-title total-recruiters-label">Recruiters participated</p>
                        <p class="highlight-description total-recruiters"></p>
                        <div class="recruiters">
                            <p class="heading-recruiter">Top Recruiters</p>
                            <div class="recruiter-logos-wrap"></div>
                        </div>
                    </div>
                `},{className:"fourth_slide",content:`
                    <div class="stories_content fourth_content"></div>
                `}].map((o,c)=>`
            <div class="stories_data_div ${o.className}" data-instituteId="${t}" data-index="${c}">
                <div class="stories_heading">
                    <div class="clgNameLogo">
                        <img class="college-logo" src="${i}" alt="${e}" loading="lazy">
                        <p class="college-name">${e}</p>
                    </div>
                    <span class="closeStories">&times;</span>
                </div>
                <div class="stories_data_overlay"></div>
                <div class="storiesDataDiv">
                    <div class="story-content-wrap">${o.content}</div>
                </div>
            </div>
        `).join(""),d="";return(!F||F==="Non-Logged-In")&&(d=`
                <a href="javascript:void(0)" class="applyNowBtn open-modal trackCTA"
                    data-modal="registrationModal" data-logo="${i}" 
                    data-instituteId="${t}" data-name="${e}"
                    data-leadcta="story-swipe-apply" data-isrequest="true" data-head="Apply Now">
                    Click to Apply
                </a>`),`
            <div class="stories_data_wrapper" data-instituteId="${t}" data-check="0">
                <div class="slider_indicators"></div>
                ${r}
                ${d} <!-- Button sirf jab user null ya undefined ho tabhi show hoga -->
                <span class="previous_story"></span>
                <span class="next_story"></span>
            </div>`}$(document).on("touchstart",".stories_data_wrapper",function(){let t=$(this);it=setTimeout(()=>{M(t)},100)}),$(document).on("touchend",".stories_data_wrapper",function(){clearTimeout(it),A("touchend")}),document.addEventListener("visibilitychange",function(){if(document.hidden){let t=$(".stories_data_wrapper:visible");M(t)}else A("tab-focus")})});
